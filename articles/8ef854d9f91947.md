---
title: "[Next.js Ã— hono Ã— supabase]supabase-ssrã‚’ä½¿ã£ã¦ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã™ã‚‹"
emoji: "ðŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [nextjs , hono , supabase , typescript , Oauth]
published: false
---
## åˆã‚ã«
ä»Šå›žã¯honoã‚’ä½¿ã£ã¦ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰supabaseã®OAuthèªè¨¼(google)ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦
ã¾ã¨ã‚ã¦ã¿ã¾ã™ã€‚
èªè¨¼ã«ã¤ã„ã¦ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’çµŒç”±ã™ã‚‹ã“ã¨ã§ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯UIã«é›†ä¸­ã•ã›ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«
ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä»»ã›ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚
### å®Ÿè£…ã™ã‚‹å†…å®¹ã«ã¤ã„ã¦
ä»¥ä¸‹ã®ã‚ˆã†ãªç‚¹ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã™ã€‚
- googleã§ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã€ãƒ­ã‚°ã‚¤ãƒ³
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±ã¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ã‚¢ã‚¤ã‚³ãƒ³ã‚’ç™»éŒ²ã•ã›ã‚‹ã€‚

## ã©ã®ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹ã®ã‹ï¼Ÿ
å®Ÿè£…æ–¹æ³•ã«ã¤ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ãƒ­ãƒ¼ã‚’è€ƒãˆã¾ã—ãŸã€‚
```mermaid
sequenceDiagram
  participant F as frontend(Next.js)
  participant B as backend(Hono)
  participant SC as Supabase client
  participant Au as Supabase Auth
  participant O as Oauthãƒ—ãƒ­ãƒã‚¤ãƒ€(google)
  F->>B : GET /api/auth/google
  B->>SC : ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆ
  SC->>Au : signInWithOAuth()ã‚’å®Ÿè¡Œ
  Au->>F : 302 Redirect Oauthã®urlã‚’è¿”ã™
  F->>G : èªè¨¼ã‚’è¨±å¯
  G->>B : GET /api/auth/callback
  B->>B : codeã‚’å–å¾—
  B->>SC : ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆã€‚
  SC->>Au : 
```